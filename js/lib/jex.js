/*
 The JeX JavaScript library.

 This library is free software: you can redistribute it and/or modify it
 under the terms of the GNU Lesser General Public License as published by
 the Free Software Foundation, either version 3 of the License, or (at your
 option) any later version.

 This library is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public
 License for more details.

 You should have received a copy of the GNU Lesser General Public License
 along with this library. If not, see <http://www.gnu.org/licenses/>.
*/
var jex={};jex.console={};jex.console.assert=function(a,b){jex.console.add_to_buffer_("assert",arguments);jex.console.flush_buffer_()};jex.console.clear=function(){jex.console.add_to_buffer_("clear",arguments);jex.console.flush_buffer_()};jex.console.count=function(a){jex.console.add_to_buffer_("count",arguments);jex.console.flush_buffer_()};jex.console.dir=function(a){jex.console.add_to_buffer_("dir",arguments);jex.console.flush_buffer_()};
jex.console.error=function(a,b){jex.console.add_to_buffer_("error",arguments);jex.console.flush_buffer_()};jex.console.exception=function(a,b){jex.console.error(a,b)};jex.console.group=function(){jex.console.add_to_buffer_("group",arguments);jex.console.flush_buffer_()};jex.console.groupCollapsed=function(){jex.console.add_to_buffer_("groupCollapsed",arguments);jex.console.flush_buffer_()};jex.console.groupEnd=function(){jex.console.add_to_buffer_("groupEnd",arguments);jex.console.flush_buffer_()};
jex.console.info=function(a,b){jex.console.add_to_buffer_("info",arguments);jex.console.flush_buffer_()};jex.console.log=function(a,b){jex.console.add_to_buffer_("log",arguments);jex.console.flush_buffer_()};jex.console.profile=function(a){jex.console.add_to_buffer_("profile",arguments);jex.console.flush_buffer_()};jex.console.profileEnd=function(a){jex.console.add_to_buffer_("profileEnd",arguments);jex.console.flush_buffer_()};
jex.console.table=function(a){jex.console.add_to_buffer_("table",arguments);jex.console.flush_buffer_()};jex.console.time=function(a){jex.console.add_to_buffer_("time",arguments);jex.console.flush_buffer_()};jex.console.timeEnd=function(a){jex.console.add_to_buffer_("timeEnd",arguments);jex.console.flush_buffer_()};jex.console.trace=function(a,b){jex.console.add_to_buffer_("trace",arguments);jex.console.flush_buffer_()};jex.console.warn=function(a,b){jex.console.add_to_buffer_("warn",arguments);jex.console.flush_buffer_()};
jex.console.buffer_=[];jex.console.add_to_buffer_=function(a,b){jex.console.buffer_.push({console_function:a,console_arguments:b})};jex.console.flush_buffer_=function(){if(window.console)for(var a;a=jex.console.buffer_.shift();)jex.console.execute_(a.console_function,a.console_arguments)};
jex.console.execute_=function(a,b){window.console[a]?"object"===typeof window.console[a]?Function.prototype.apply.apply(window.console[a],[window.console,b]):window.console[a].apply(window.console,b):"log"!==a&&jex.console.execute_("log",b)};jex.ie={};jex.ie.less_than=function(a){return jex.ie.get_version()?jex.ie.get_version()<a:!1};jex.ie.greater_than=function(a){return jex.ie.get_version()?jex.ie.get_version()>a:!1};jex.ie.equals=function(a){return a===jex.ie.get_version()};
jex.ie.get_version=function(){jex.ie.version_||(jex.ie.version_=document.all&&window.atob?10:document.all&&!window.atob&&document.addEventListener?9:document.all&&!document.addEventListener&&document.querySelector?8:document.all&&!document.querySelector&&window.XMLHttpRequest?7:document.all&&!window.XMLHttpRequest&&document.compatMode?6:null);return jex.ie.version_};jex.type=function(a,b){1===arguments.length&&(b=!1);if(null===a)return"null";if(void 0===a)return"undefined";if(!1===b){if("string"===typeof a||a instanceof String)return"string";if("number"===typeof a||a instanceof Number)return"number";if("boolean"===typeof a||a instanceof Boolean)return"boolean";if(a instanceof Array)return"array";if(a instanceof Function)return"function";if(a instanceof RegExp)return"regexp";if(a instanceof Date)return"date"}var c=Object.prototype.toString.call(a);return jex.type.map_[c]?
jex.type.map_[c]:c.match(jex.type.regexp_)[1].toLowerCase()};jex.type.regexp_=/\s([a-zA-Z]+)/;jex.type.map_={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object Null]":"null","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string","[object Undefined]":"undefined"};jex.table=function(a){var b=a.rows||(!0===a.header?1:0);this.columns_=a.columns||0;this.table_=rocket.createElement("table");this.table_.setAttribute({cellpadding:"0",cellspacing:"0"});this.tbody_=rocket.createElement("tbody");this.trs_=[];this.tds_=[];!0===a.header&&(b--,this.thead_=rocket.createElement("thead"),a=this.render_tr_("th"),this.trs_.push(a),this.thead_.appendChild(a),this.table_.appendChild(this.thead_));rocket.createElement("tbody");for(var c=0;c<b;c++)a=this.render_tr_("td"),this.trs_.push(a),
this.tbody_.appendChild(a);this.table_.appendChild(this.tbody_)};jex.table.prototype.render_tr_=function(a,b){for(var c=b||this.trs_.length,d=rocket.createElement("tr"),e=[],f,g=0;g<this.columns_;g++)f=rocket.createElement(a),e.push(f),d.appendChild(f);this.tds_.splice(c,0,e);return d};jex.table.prototype.fill_row=function(a,b){for(var c=0,d=b.length;c<d;c++)"object"===jex.type(b[c])?(this.td(c,a).innerHTML(""),this.td(c,a).appendChild(b[c])):this.td(c,a).innerHTML(b[c])};
jex.table.prototype.add_row=function(a){var b=a||this.trs_.length;a=this.render_tr_("td",a);this.tbody_.insertBefore(a,this.trs_[b]);this.trs_.splice(b,0,a);return b};jex.table.prototype.remove_row=function(a){this.trs_[a].parentNode().removeChild(this.trs_[a]);this.trs_.splice(a,1);this.tds_.splice(a,1);return this.trs_.length};jex.table.prototype.table=function(){return this.table_};jex.table.prototype.thead=function(){return this.thead_};jex.table.prototype.tbody=function(){return this.tbody_};
jex.table.prototype.tr=function(a){return this.trs_[a]};jex.table.prototype.td=function(a,b){return this.tds_[b][a]};jex.debug={};jex.debug.listener={};
jex.debug.listener.render_count=function(){var a=rocket.createElement("div").style({position:"fixed",bottom:"0",right:"0",background:"#fff",padding:"4px",opacity:".8"});a.innerHTML("Listeners: "+jex.debug.listener.get_count());document.body.appendChild(a[0]);var b=rocket.EventTarget.prototype.addEventListener;rocket.EventTarget.prototype.addEventListener=function(){b.apply(this,arguments);a.innerHTML("Listeners: "+jex.debug.listener.get_count())};var c=rocket.EventTarget.prototype.removeEventListener;rocket.EventTarget.prototype.removeEventListener=
function(){c.apply(this,arguments);a.innerHTML("Listeners: "+jex.debug.listener.get_count())}};jex.debug.listener.get_count=function(){var a=0,b,c=rocket.EventTarget.getListenerTree(),d;for(d in c){b=parseInt(d,10);for(var e in c[b])for(var f in c[b][e])a+=c[b][e][f].length}return a};jex.hashchange=function(){var a=this;this.hash_=location.hash;!0===jex.ie.less_than(8)&&(this.iframe_=rocket.createElement("iframe"),rocket.$("body").appendChild(this.iframe_),this.iframe_.setAttribute({src:"javascript:void(0)"}));"onhashchange"in window?window.onhashchange=function(){a.dispatchEvent("hashchange")}:rocket.setInterval(function(){a.check_()},1E3)};rocket.inherits(jex.hashchange,rocket.EventTarget);
jex.hashchange.prototype.check_=function(){if(location.hash!==this.hash_)this.set_(location.hash),this.dispatchEvent("hashchange");else if(this.iframe_){var a=this.iframe_[0];a.contentWindow.location.hash!==this.hash_&&(this.set_(a.contentWindow.location.hash),this.dispatchEvent("hashchange"))}};jex.hashchange.prototype.set_=function(a){this.hash_=a;if(this.iframe_){var b=this.iframe_[0];b.contentWindow.document.open();b.contentWindow.document.close();b.contentWindow.location.hash=a}};jex.version="15.11";jex.hotkey={};jex.hotkey.hotkeys_=[];jex.hotkey.current_hotkey_="";jex.hotkey.is_active_=!1;jex.hotkey.sequence_timeout_=1E3;
jex.hotkey.keycode_map_={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",186:";",187:"=",188:",",109:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",37:"left",38:"up",39:"right",40:"down",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",
123:"f12",13:"enter",32:"space",20:"capslock",144:"numlock",145:"scrolllock",45:"insert",46:"delete",36:"home",35:"end",33:"pageup",34:"pagedown",9:"tab",19:"break",8:"backspace",27:"escape",107:"+",106:"*",111:"/",110:".",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",91:"start",92:"start",93:"menu",224:"command",16:"shift",17:"ctrl",18:"alt"};
jex.hotkey.shift_keycode_map_={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",186:":",187:"+",188:"<",109:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'};
jex.hotkey.add=function(a){var b=jex.hotkey.has_listener_();!1===b&&(jex.hotkey.hotkeys_=[]);for(var c=[].concat(a.hotkey),d=[].concat(a.input||[]),e=0,f=d.length;e<f;++e)d[e]=d[e][0];e=0;for(f=c.length;e<f;++e)jex.hotkey.hotkeys_.push({hotkey:jex.hotkey.normalize_(c[e]),callback:a.callback,inputs:d});!1===b&&jex.hotkey.add_listener_();jex.hotkey.reset_();return jex.hotkey.hotkeys_.length-1};jex.hotkey.remove=function(a){jex.hotkey.hotkeys_.splice(a,1);0===jex.hotkey.hotkeys_.length&&jex.hotkey.remove_listener_()};
jex.hotkey.has_listener_=function(){var a=rocket.EventTarget.getListenerTree(),b;for(b in a)for(var c in a[+b])for(var d in a[+b][c])if("jex.hotkey"===d)return!0;return!1};jex.hotkey.add_listener_=function(){rocket.$(window).addEventListener("keydown.jex.hotkey",jex.hotkey.keydown_handler_)};jex.hotkey.remove_listener_=function(){jex.hotkey.is_active_=!1;rocket.$(window).removeEventListener(".jex.hotkey")};
jex.hotkey.normalize_=function(a){a=rocket.trim(a).replace(/\s{2,}/g," ").toLowerCase();a=a.replace("ctrl+shift","shift+ctrl");a=a.replace("alt+shift","shift+alt");a=a.replace("alt+ctrl","ctrl+alt");a=a.replace("shift+alt+ctrl","shift+ctrl+alt");a=a.replace("ctrl+shift+alt","shift+ctrl+alt");a=a.replace("ctrl+alt+shift","shift+ctrl+alt");a=a.replace("alt+shift+ctrl","shift+ctrl+alt");a=a.replace("alt+ctrl+shift","shift+ctrl+alt");a=a.replace("plus","+");a=a.replace("return","enter");a=a.replace(/\bins\b/g,
"insert");a=a.replace(/\bdel\b/g,"delete");a=a.replace(/\besc\b/g,"escape");a=a.replace("pgup","pageup");a=a.replace("pgdn","pagedown");a=a.replace("pgdown","pagedown");return a=a.replace("break","pause")};
jex.hotkey.keydown_handler_=function(a){var b=a.target;!0===("INPUT"===b.tagName||"SELECT"===b.tagName||"TEXTAREA"===b.tagName||!0===b.isContentEditable)&&jex.hotkey.reset_();b="keycode_map_";!0===a.originalEvent.shiftKey&&16!==a.which&&jex.hotkey.shift_keycode_map_[a.which+""]&&(b="shift_keycode_map_");jex.hotkey[b][a.which]&&(""!==jex.hotkey.current_hotkey_&&(jex.hotkey.current_hotkey_+=" "),jex.hotkey.current_hotkey_+=jex.hotkey[b][a.which]);for(var b=rocket.filter(jex.hotkey.hotkeys_,function(b){return 0<
b.inputs.length?b.hotkey===jex.hotkey.current_hotkey_&&-1!==rocket.indexOf(b.inputs,a.target):b.hotkey===jex.hotkey.current_hotkey_}),c=0,d=b.length;c<d;++c)b[c].callback();0<b.length?(jex.hotkey.reset_(),a.preventDefault()):(clearTimeout(jex.hotkey.sequence_timeout_handle_),jex.hotkey.sequence_timeout_handle_=setTimeout(jex.hotkey.reset_,jex.hotkey.sequence_timeout_))};jex.hotkey.reset_=function(){clearTimeout(jex.hotkey.sequence_timeout_handle_);jex.hotkey.current_hotkey_=""};
